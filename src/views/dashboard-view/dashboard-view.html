<mat-accordion class="dashboard-container" multi>

  <!-- === ĮMONĖS TABLE === -->
  <mat-expansion-panel expanded>
    <mat-expansion-panel-header>
      <mat-panel-title> Įmonės </mat-panel-title>
      <mat-panel-description> Peržiūrėti registruotas įmones </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-card class="dashboard-card">
      <mat-card-content>
        @if (loading && (dataSourceCompanies.data.length === 0 || dataSourceClients.data.length === 0)) {
          <div class="spinner-container">
            <mat-progress-spinner color="accent" mode="indeterminate"></mat-progress-spinner>
          </div>
        }

        <div class="table-container">
          <table mat-table [dataSource]="dataSourceCompanies" matSort #sortCompanies="matSort" class="mat-elevation-z2">

            <ng-container matColumnDef="companyName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Pavadinimas </th>
              <td mat-cell *matCellDef="let row"> {{ row.companyName }} </td>
            </ng-container>

            <ng-container matColumnDef="companyCode">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Kodas </th>
              <td mat-cell *matCellDef="let row"> {{ row.companyCode || '-' }} </td>
            </ng-container>

            <ng-container matColumnDef="vatCode">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> PVM kodas </th>
              <td mat-cell *matCellDef="let row"> {{ row.vatCode || '-' }} </td>
            </ng-container>

            <ng-container matColumnDef="address">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Adresas </th>
              <td mat-cell *matCellDef="let row"> {{ row.address }} </td>
            </ng-container>

            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> El. paštas </th>
              <td mat-cell *matCellDef="let row"> {{ row.email }} </td>
            </ng-container>

            <ng-container matColumnDef="phone">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Telefonas </th>
              <td mat-cell *matCellDef="let row"> {{ row.phone || '-' }} </td>
            </ng-container>

            <ng-container matColumnDef="createdAt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Sukurta </th>
              <td mat-cell *matCellDef="let row"> {{ row.createdAt | date:'yyyy-MM-dd HH:mm' }} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsCompanies"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsCompanies;"></tr>
          </table>

          <mat-paginator
            #paginatorCompanies
            [pageSize]="5"
            [pageSizeOptions]="[5, 10, 20]"
            showFirstLastButtons>
          </mat-paginator>
        </div>
      </mat-card-content>
    </mat-card>
  </mat-expansion-panel>

  <!-- === KLIENTAI TABLE === -->
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title> Klientai </mat-panel-title>
      <mat-panel-description> Peržiūrėti registruotus klientus </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-card class="dashboard-card">
      <mat-card-content>
        <div class="table-container">
          <table mat-table [dataSource]="dataSourceClients" matSort #sortClients="matSort" class="mat-elevation-z2">

            <ng-container matColumnDef="firstName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Vardas </th>
              <td mat-cell *matCellDef="let row"> {{ row.firstName }} </td>
            </ng-container>

            <ng-container matColumnDef="lastName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Pavardė </th>
              <td mat-cell *matCellDef="let row"> {{ row.lastName }} </td>
            </ng-container>

            <ng-container matColumnDef="position">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Pareigos </th>
              <td mat-cell *matCellDef="let row"> {{ row.position }} </td>
            </ng-container>

            <ng-container matColumnDef="phone">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Telefonas </th>
              <td mat-cell *matCellDef="let row"> {{ row.phone }} </td>
            </ng-container>

            <ng-container matColumnDef="createdAt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Sukurta </th>
              <td mat-cell *matCellDef="let row"> {{ row.createdAt | date:'yyyy-MM-dd HH:mm' }} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsClients"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsClients;"></tr>
          </table>

          <mat-paginator
            #paginatorClients
            [pageSize]="5"
            [pageSizeOptions]="[5, 10, 20]"
            showFirstLastButtons>
          </mat-paginator>
        </div>
      </mat-card-content>
    </mat-card>
  </mat-expansion-panel>
</mat-accordion>
